(this.webpackJsonpirida=this.webpackJsonpirida||[]).push([[0],{136:function(e,t,a){},137:function(e,t,a){},149:function(e,t,a){},150:function(e,t,a){},151:function(e,t,a){},152:function(e,t,a){},169:function(e,t){},171:function(e,t){},195:function(e,t,a){},196:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),s=a(38),r=a.n(s),o=a(10),l=a(13),i=(a(136),a(59)),d=a(18),j=(a(137),a(90)),u=a(92),b=a.n(u),h=a(201),m=a(202),O=a(198),f=a(82),x=a(4);var p=function(e){var t=Object(c.useRef)(),a=function(e){e.preventDefault();var a,c="";c=""===e.target.name.value?"Anonymous":e.target.name.value,a=e.target.issue.value,f.a.database().ref("Users").orderByChild("profile/engaged").once("value",(function(e){if(e.forEach((function(e){0===e.val().profile.engaged&&(t=e.val())})),t.profile){var n=function(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=a.length,n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*c));return t}(6);console.log(t);var s=f.a.database().ref("rooms").child(n),r=new Date,o={volunteer:t.profile.name,createdAt:r,cient:c,issue:a,cert:t.profile.cert};s.set(o,(function(e){e&&console.log(e)})),f.a.database().ref("Users").orderByChild("profile/cert").equalTo(t.profile.cert).once("value").then((function(e){e.forEach((function(e){return e.ref.child("profile").update({engaged:1,tempRoomId:n}).then((function(){window.location.href="/room/"+n})),!0}))}))}else alert("No available volunteers, please wait for some time.. ")})).catch((function(e){var t=e.code,a=e.message;console.log(a,t)}))};return Object(x.jsxs)(h.a,Object(o.a)(Object(o.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(x.jsx)(h.a.Header,{closeButton:!0,children:Object(x.jsx)(h.a.Title,{id:"contained-modal-title-vcenter",children:"Enter details"})}),Object(x.jsx)(h.a.Body,{children:Object(x.jsxs)(m.a,{onSubmit:function(e){return a(e)},children:[Object(x.jsxs)(m.a.Group,{controlId:"formGridName",children:[Object(x.jsx)(m.a.Label,{children:"Name"}),Object(x.jsx)(m.a.Control,{name:"name",placeholder:"Anonymous"})]}),Object(x.jsxs)(m.a.Group,{controlId:"formGridIssue",children:[Object(x.jsx)(m.a.Label,{children:"What type of issue are you facing?"}),Object(x.jsx)(m.a.Control,{name:"issue",placeholder:"Stress, Anxiety, ...."})]}),Object(x.jsx)(O.a,{variant:"success",type:"submit",children:"Join Room"})]})}),Object(x.jsx)(h.a.Footer,{children:Object(x.jsx)(O.a,{onClick:e.onHide,children:"Close"})})]}))},g=function(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],s=Object(j.useSpring)({from:{transform:"scale(1.5)",overflow:"hidden"},to:{transform:"scale(1)",overflow:"hidden"},config:{duration:500}});return Object(c.useEffect)((function(){b()("#root").addClass("overflow-none"),setTimeout((function(){b()("#root").removeClass("overflow-none")}),1e3)}),[]),Object(x.jsxs)(j.animated.section,{style:s,className:"home",children:[Object(x.jsx)("div",{className:"bg-skew"}),Object(x.jsxs)("div",{className:"center-out",children:[Object(x.jsxs)("h2",{children:[" ",Object(x.jsx)("b",{children:"You are doing well! Lets converse "})]}),Object(x.jsx)("h4",{children:"To get started click the button below"}),Object(x.jsx)("div",{className:"call-button",onClick:function(){return n(!a)},children:Object(x.jsx)("i",{className:"fas fa-phone-alt"})})]}),Object(x.jsx)(p,{show:a,onHide:function(){return n(!1)}})]})},v=a(204),y=a(203),w=a(81),N=(a(144),a(145),{apiKey:"AIzaSyDnFMvqkULMTKi83QrG_QyietKYoiah6sI",authDomain:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_STORAGE_BUCKET:"ek-database.appspot.com",REACT_APP_AUTH_DOMAIN:"ek-database.firebaseapp.com",REACT_APP_PROJECT_ID:"ek-database",REACT_APP_APP_ID:"1:503059163051:web:2b85294379d4e4fadc94ee",REACT_APP_API_KEY:"AIzaSyDnFMvqkULMTKi83QrG_QyietKYoiah6sI",REACT_APP_DATABASE_URL:"https://ek-database-default-rtdb.firebaseio.com",REACT_APP_MESSAGING_SENDER_ID:"503059163051"}).REACT_AUTH_DOMAIN,databaseURL:"https://ek-database-default-rtdb.firebaseio.com",projectId:"ek-database",storageBucket:"ek-database.appspot.com",messagingSenderId:"503059163051",appId:"1:503059163051:web:2b85294379d4e4fadc94ee"}),C=w.a.apps.length?w.a.app():w.a.initializeApp(N),S=function(e){var t=e.logged,a=e.setLogged;return Object(x.jsxs)(v.a,{fixed:"top",collapseOnSelect:!0,expand:"sm",variant:"dark",children:[Object(x.jsx)(i.b,{to:"/",children:Object(x.jsx)(v.a.Brand,{className:"logo-text",children:"ek"})}),Object(x.jsx)(v.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(x.jsx)(v.a.Collapse,{id:"responsive-navbar-nav",children:t?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(y.a,{className:"ml-auto",children:Object(x.jsx)(i.b,{to:"/dashboard",children:Object(x.jsx)(v.a.Text,{className:"mx-3",children:"Dashboard"})})}),Object(x.jsx)(y.a,{children:Object(x.jsx)(O.a,{variant:"danger",onClick:function(){var e=C.auth().currentUser.uid;C.database().ref("Users").child(e+"/profile").update({engaged:1}),C.auth().signOut(),a(!1)},children:Object(x.jsx)(v.a.Text,{className:"mx-3",children:"Logout"})})})]}):Object(x.jsx)(y.a,{className:"ml-auto",children:Object(x.jsx)(i.b,{to:"/volunteer",children:Object(x.jsx)(v.a.Text,{className:"mx-3",children:"Volunteer here"})})})})]})},A=(a(148),a(149),a(199)),k=a(200),I=a(128),E=(a(150),function(e){var t=e.auth,a=e.setAuth,c=(e.logged,e.setLogged);return C.auth().onAuthStateChanged((function(e){c(!!e)})),Object(x.jsx)("section",{className:"signin w-75",children:Object(x.jsxs)(m.a,{className:"form-neo",onSubmit:function(e){e.preventDefault(),""===e.target.email.value||""===e.target.pwd.value?alert("Login details cannot be empty"):C.auth().signInWithEmailAndPassword(e.target.email.value,e.target.pwd.value).then((function(e){var t=C.auth().currentUser.uid;C.database().ref("Users").child(t+"/profile").update({engaged:0}),alert("Login Successful"),c(!0)})).catch((function(e){alert(e)}))},children:[Object(x.jsx)(m.a.Row,{children:Object(x.jsxs)("h3",{className:"py-2",children:["Signin | ",Object(x.jsx)("span",{className:"logo-text mx-0",children:"ek   "})]})}),Object(x.jsxs)(m.a.Group,{controlId:"formGridEmail",children:[Object(x.jsx)(m.a.Label,{children:"Email"}),Object(x.jsx)(m.a.Control,{name:"email",type:"email",placeholder:"Enter email"})]}),Object(x.jsxs)(m.a.Group,{controlId:"formGridPassword",children:[Object(x.jsx)(m.a.Label,{children:"Password"}),Object(x.jsx)(m.a.Control,{name:"pwd",type:"password",placeholder:"Password"})]}),Object(x.jsx)(O.a,{variant:"primary",type:"submit",children:"Login"}),Object(x.jsx)(m.a.Row,{children:Object(x.jsxs)("span",{className:"my-2",children:["Don't have an account ? ",Object(x.jsx)("span",{className:"text-primary",onClick:function(){return a(!t)},children:"Signup"})]})})]})})}),T=(a(151),function(e){return C.auth().onAuthStateChanged((function(t){t&&e.setLogged(1)})),Object(x.jsxs)(m.a,{className:"form-neo",onSubmit:function(e){e.preventDefault(),console.log(e.target.name.value);var t=e.target.email.value,a=e.target.pwd.value;C.auth().createUserWithEmailAndPassword(t,a).then((function(t){var a=t.user,c=C.database().ref("Users").child(a.uid),n=new Date,s={name:e.target.name.value,mobile:e.target.phone.value,cert:e.target.certID.value,created:n.getTime(),engaged:0};c.set({profile:s},(function(e){e&&alert(e)}))})).catch((function(e){var t=e.code,a=e.message;alert(a,t)}))},children:[Object(x.jsx)(m.a.Row,{children:Object(x.jsxs)("h3",{className:"py-2",children:["Volunteer Signup | ",Object(x.jsx)("span",{className:"logo-text mx-0",children:"ek"})]})}),Object(x.jsxs)(m.a.Row,{children:[Object(x.jsxs)(m.a.Group,{as:I.a,controlId:"formGridName",children:[Object(x.jsx)(m.a.Label,{children:"Name"}),Object(x.jsx)(m.a.Control,{name:"name",placeholder:"Enter fullname"})]}),Object(x.jsxs)(m.a.Group,{as:I.a,controlId:"formGridPassword",children:[Object(x.jsx)(m.a.Label,{children:"Password"}),Object(x.jsx)(m.a.Control,{name:"pwd",type:"password",placeholder:"Password"})]})]}),Object(x.jsxs)(m.a.Group,{controlId:"formGridEmail",children:[Object(x.jsx)(m.a.Label,{children:"Email"}),Object(x.jsx)(m.a.Control,{name:"email",type:"email",placeholder:"Enter email"})]}),Object(x.jsxs)(m.a.Group,{controlId:"formGridMobile",children:[Object(x.jsx)(m.a.Label,{children:"Phone Number"}),Object(x.jsx)(m.a.Control,{name:"phone",placeholder:"+91 0000000000"})]}),Object(x.jsxs)(m.a.Group,{controlId:"formCertificationId",children:[Object(x.jsxs)(m.a.Label,{children:["Certification ID ",Object(x.jsxs)("b",{children:["(   If not certified ",Object(x.jsx)("a",{href:"https://nhsvolunteerresponders.org.uk/volunteer-resources",children:" click here "}),") "]})," "]}),Object(x.jsx)(m.a.Control,{name:"certID",placeholder:"Certification ID"})]}),Object(x.jsx)(m.a.Group,{id:"formGridCheckbox",children:Object(x.jsx)(m.a.Check,{type:"checkbox",label:"Agree to company's terms and conditions"})}),Object(x.jsx)(O.a,{variant:"success",type:"submit",children:"Signup"}),Object(x.jsx)(m.a.Row,{children:Object(x.jsxs)("span",{className:"my-2",children:["Already have an account ? ",Object(x.jsx)("span",{className:"text-primary",onClick:function(){return e.setAuth(!e.auth)},children:"Login"})]})})]})}),_=(a(152),function(e){var t=e.logged,a=e.setLogged,n=Object(c.useState)(0),s=Object(l.a)(n,2),r=s[0],o=s[1];return Object(x.jsx)(A.a,{className:"auth",fluid:!0,children:Object(x.jsxs)(k.a,{className:"w-100 mx-auto",children:[Object(x.jsx)(I.a,{className:"banner text-light d-md-flex d-none align-items-center",children:Object(x.jsxs)("div",{className:"banner-content",children:[Object(x.jsx)("b",{children:Object(x.jsx)("h1",{children:"Get Certified"})}),Object(x.jsx)("p",{className:"w-75 h5",children:"Working as a volunteer to help others requires a skill. Enroll in our programme to become a certified volunteer. "}),Object(x.jsx)(O.a,{href:"https://nhsvolunteerresponders.org.uk/i-want-to-volunteer",children:"Enroll now"})]})}),Object(x.jsx)(I.a,{md:5,className:"d-flex justify-content-center align-items-center",children:r?Object(x.jsx)(E,{auth:r,setAuth:o,logged:t,setLogged:a}):Object(x.jsx)(T,{auth:r,setAuth:o,logged:t,setLogged:a})})]})})}),P=function(){var e=Object(c.useState)(0),t=Object(l.a)(e,2),a=t[0],n=t[1],s=Object(c.useCallback)((function(){var e=C.auth().currentUser;n(e);var t=e.uid;C.database().ref("Users").child(t+"/profile").on("value",(function(e){n(e.val())}))}),[n]);return Object(c.useEffect)((function(){s()}),[s]),Object(x.jsx)(A.a,{className:"auth",fluid:!0,children:Object(x.jsx)(k.a,{className:"w-100 mx-auto",children:Object(x.jsxs)(I.a,{className:"d-flex justify-content-center align-items-center flex-column",children:[Object(x.jsxs)("h1",{children:["Welcome ",a.name," !"]}),Object(x.jsx)("h3",{children:a.cert}),Object(x.jsx)("h3",{children:a.tempRoomId?window.location.href="/room/"+a.tempRoomId+"v0lUn":Object(x.jsx)(x.Fragment,{})}),Object(x.jsxs)("h3",{children:[a.engaged?"Engaged":"Available"," "]})]})})})},L=a(95),R=a.n(L),D=a(130),G=a.n(D),U=(a(195),G.a.connect("https://ek-backend.herokuapp.com/")),M=function(e){var t=Object(c.useState)(0),a=Object(l.a)(t,2),n=a[0],s=a[1],r=Object(c.useState)(0),o=Object(l.a)(r,2),i=o[0],d=o[1],j=Object(c.useState)(""),u=Object(l.a)(j,2),b=u[0],h=u[1],m=Object(c.useState)(),f=Object(l.a)(m,2),p=f[0],g=f[1],v=Object(c.useState)(!1),y=Object(l.a)(v,2),w=y[0],N=y[1],S=Object(c.useState)(""),E=Object(l.a)(S,2),T=E[0],_=E[1],P=Object(c.useState)(),L=Object(l.a)(P,2),D=L[0],G=L[1],M=Object(c.useState)(!1),B=Object(l.a)(M,2),K=B[0],W=B[1],F=Object(c.useState)(!1),H=Object(l.a)(F,2),V=H[0],q=H[1],Y=Object(c.useState)(""),z=Object(l.a)(Y,2),J=z[0],Q=z[1],X=Object(c.useState)(0),Z=Object(l.a)(X,2),$=Z[0],ee=Z[1],te=Object(c.useState)(0),ae=Object(l.a)(te,2),ce=ae[0],ne=ae[1],se=Object(c.useRef)(),re=Object(c.useRef)(),oe=Object(c.useRef)();Object(c.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){g(e),se.current.srcObject=e})),U.on("me",(function(t){h(t);var a=C.database().ref("rooms").child(e.match.params.id.slice(0,6));a.on("value",(function(e){e.val()&&(s(e.val()),d(e.val().cert))})),6===e.match.params.id.length?(ee(0),a.update({userSocketId:t},(function(e){e&&console.log(e)}))):(ee(1),a.update({volunteerSocketId:t},(function(e){e&&console.log(e)})))})),U.on("callUser",(function(e){N(!0),_(e.from),Q(e.name),G(e.signal)}))}),[e.match.params.id]);return Object(x.jsxs)(A.a,{className:"room",fluid:!0,children:[Object(x.jsxs)(k.a,{className:"video-col mt-4",children:[Object(x.jsxs)("div",{className:"col col-12 col-md-6",children:[Object(x.jsx)("h3",{children:"You"}),p&&Object(x.jsx)("video",{playsInline:!0,muted:!0,ref:se,autoPlay:!0,className:"video-container my-3"})]}),Object(x.jsx)("div",{className:"col col-md-6 col-12",children:K&&!V?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h3",{children:$?"Client":"Volunteer"}),Object(x.jsx)("video",{playsInline:!0,ref:re,autoPlay:!0,className:"video-container"})]}):null})]}),$||ce?ce&&!K?Object(x.jsx)(k.a,{children:Object(x.jsx)(I.a,{className:"mt-4 call-col bg-light py-3 my-4 d-flex justify-content-center flex-column",children:Object(x.jsx)("h4",{children:"Waiting for Volunteer to connect"})})}):!$||w||K?$&&w&&!K?Object(x.jsx)(k.a,{children:Object(x.jsxs)(I.a,{className:"mt-4 call-col bg-light py-3 my-4 d-flex justify-content-center flex-column",children:[Object(x.jsx)("h4",{children:"A client wants to connect with you"}),Object(x.jsx)(O.a,{variant:"success",onClick:function(){!function(){W(!0),N(!1);var e=new R.a({initiator:!1,trickle:!1,stream:p});e.on("signal",(function(e){U.emit("answerCall",{signal:e,to:T})})),e.on("stream",(function(e){re.current.srcObject=e})),e.signal(D),oe.current=e}()},children:"Connect"})]})}):K&&!V?Object(x.jsx)(k.a,{children:Object(x.jsxs)(I.a,{className:"mt-4 call-col bg-light py-3 my-4 d-flex justify-content-center flex-column",children:[Object(x.jsx)("h4",{children:"If you wish to end the call, click on the button below"}),Object(x.jsx)(O.a,{variant:"danger",onClick:function(){if($){var t=0;C.database().ref("Users").orderByChild("profile/cert").equalTo(i).on("value",(function(e){for(var a in e.val()){var c=C.database().ref("Users");c.child(a+"/profile").update({engaged:0},(function(e){e&&console.log(e)})),c.child(a+"/profile/tempRoomId").remove(),t=1}})),C.database().ref("rooms").child(e.match.params.id.slice(0,6)).remove(),t&&(oe.current.destroy(),q(!0),window.location.href="/")}else oe.current.destroy(),q(!0),window.location.href="/"},children:"Leave Call"})]})}):Object(x.jsx)(x.Fragment,{}):Object(x.jsx)(k.a,{children:Object(x.jsx)(I.a,{className:"mt-4 call-col bg-light py-3 my-4 d-flex justify-content-center flex-column",children:Object(x.jsx)("h4",{children:"If a client calls, it will show up here.. Currently no one is calling"})})}):Object(x.jsx)(k.a,{children:Object(x.jsxs)(I.a,{className:"mt-4 call-col bg-light py-3 my-4 d-flex justify-content-center flex-column",children:[Object(x.jsx)("h4",{children:"When ready, click on the call button to initiate a video chat with our volunteer"}),Object(x.jsxs)(O.a,{variant:"success",onClick:function(){ne(1),function(e){var t=new R.a({initiator:!0,trickle:!1,stream:p});t.on("signal",(function(t){U.emit("callUser",{userToCall:e,signalData:t,from:b,name:J})})),t.on("stream",(function(e){re.current.srcObject=e})),U.on("callAccepted",(function(e){W(!0),t.signal(e)})),oe.current=t}(n.volunteerSocketId)},children:[Object(x.jsx)("i",{className:"fas fa-phone-alt"}),"  Call Volunteer"]})]})}),Object(x.jsx)(k.a,{children:Object(x.jsx)(I.a,{className:"mt-4 utility-col py-3 m-4 d-flex justify-content-center",children:Object(x.jsxs)(A.a,{className:"m-4",children:[Object(x.jsxs)("h3",{children:["Client : ",n.cient," "]}),Object(x.jsxs)("p",{children:["Problems : ",n.issue]}),Object(x.jsxs)("h3",{children:["Volunteer :  ",n.volunteer]}),Object(x.jsxs)("p",{children:["Certification ID: ",n.cert]})]})})})]})},B=a(25);var K=function(){var e=Object(c.useState)(0),t=Object(l.a)(e,2),a=t[0],n=t[1],s=Object(B.a)();return Object(x.jsxs)(i.a,{history:s,children:[Object(x.jsx)(S,{logged:a,setLogged:n}),a?Object(x.jsxs)(d.d,{children:[Object(x.jsx)(d.b,{exact:!0,path:"/room/:id",render:function(e){return Object(x.jsx)(M,Object(o.a)({},e))}}),Object(x.jsx)(d.b,{path:"/dashboard",exact:!0,component:function(){return Object(x.jsx)(P,{setLogged:n})}}),Object(x.jsx)(d.b,{path:"/",render:function(){return Object(x.jsx)(d.a,{to:"/dashboard"})}})]}):Object(x.jsxs)(d.d,{children:[Object(x.jsx)(d.b,{exact:!0,path:"/room/:id",render:function(e){return Object(x.jsx)(M,Object(o.a)({},e))}}),Object(x.jsx)(d.b,{exact:!0,path:"/volunteer",children:Object(x.jsx)(_,{logged:a,setLogged:n})}),Object(x.jsx)(d.b,{path:"/",children:Object(x.jsx)(g,{})})]})]})};r.a.render(Object(x.jsx)(n.a.StrictMode,{children:Object(x.jsx)(K,{})}),document.getElementById("root"))}},[[196,1,2]]]);
//# sourceMappingURL=main.0d050f4e.chunk.js.map